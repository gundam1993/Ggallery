!function(e){"use strict"
function t(e){this.LAYOUT={PUZZLE:1,WATERFALL:2,BARREL:3,SQUARE:4},this.containerSelector=e||"#ggalleryContainer",this.container=document.querySelector(this.containerSelector),this.picBox="ggalleryBox"}var i={layout:"",puzzleHeight:"",coulumn:"",heightMin:"",gutter:"",squareSize:"",fullscreenState:"",image:[],imageUrl:[],imageNum:"",barrelBinAspectRationow:0,barrelBinCheckedImg:[]},r=function(){if(event.target.getAttribute("src")){var e=document.createElement("div"),t=document.createElement("img"),r=document.createElement("div"),n=document.createElement("div"),a=document.querySelector("body")
e.id="gGalleryFullscreen",r.id="gGalleryLeftArrow",n.id="gGalleryRightArrow",t.src=event.target.src,t.className="bigPic",t.id=event.target.id,e.appendChild(t),e.appendChild(r),e.appendChild(n),a.appendChild(e),setTimeout(function(){var e=document.querySelector(".bigPic")
e.style.transform="translate(-50%, -50%)"},10),e.onclick=function(){var e=document.querySelector("#gGalleryFullscreen"),t=document.querySelector("#gGalleryLeftArrow"),r=document.querySelector("#gGalleryRightArrow"),n=document.querySelector(".bigPic")
if(event.target!==t&&event.target!==r&&event.target!==n&&(n.style.transform="translate(-50%, -50%) scale(0.01,0.01)",setTimeout(function(){e.remove()},300)),event.target===t&&"Pic1"!==n.id){var a="Pic"+(n.id.slice(3)-1)
n.remove()
var l=new Image,o=document.querySelector("#"+a)
l.src=o.src,l.className="bigPic",l.id=a,l.style.transform="translate(-50%, -50%)",e.appendChild(l)}if(event.target===r&&n.id!=="Pic"+i.imageNum){var c="Pic"+(parseInt(n.id.slice(3))+1)
n.remove()
var s=new Image,h=document.querySelector("#"+c)
s.src=h.src,s.id=c,s.className="bigPic",s.style.transform="translate(-50%, -50%)",e.appendChild(s)}}}},n=function(e,t){var i=e.length
switch(i){case 3:e[1].style.width=e[1].offsetHeight+"px",e[2].style.width=e[2].offsetHeight+"px",e[0].style.width=t.offsetWidth-e[1].offsetWidth+"px"
break
case 5:e[1].style.height=e[1].offsetWidth+"px",e[4].style.height=t.offsetHeight-e[1].offsetHeight+"px"
break
default:for(var r=0;i>r;r++)e[r].style.height="",e[r].style.width=""}}
t.prototype.setImage=function(t,r){if("string"==typeof t)return void this.setImage([t])
this.container.innerHTML="",this.container.style.height=""
var n=r||{}
i.layout=n.layout||2,i.fullscreenState=n.fullscreenState||!0,i.puzzleHeight=n.puzzleHeight||800,i.coulumn=n.coulumn||4,i.heightMin=n.heightMin||300,i.gutter=n.gutter||0,i.squareSize=n.squareSize||25,i.image=[],i.imageUrl=[],i.imageNum=0,i.barrelBinAspectRationow=0,i.barrelBinCheckedImg=[],this.setLayout(i.layout),this.addImage(t,0),e.onresize=this.setImage.bind(this,i.imageUrl,i)},t.prototype.getImageDomElements=function(){return document.querySelectorAll(".ggalleryBox")},t.prototype.addImage=function(e,t){var r=new Image,a=document.createElement("div")
switch(r.src=e[t],i.imageUrl.push(e[t]),i.imageNum++,a.style.border=i.gutter/2+"px solid transparent",a.className=this.picBox,r.id="Pic"+i.imageNum,r.className="images",a.appendChild(r),i.image.push(a),i.layout){case 1:if(i.image.length>6)throw"PUZZLE layout only can contain 6 photos"
this.container.appendChild(a),this.container.style.height=i.puzzleHeight+"px",this.container.className=this.containerSelector.slice(1)+" puzzle-"+i.image.length,n(i.image,this.container)
break
case 2:var l=this.getMinWaterfallCoulumn()
l[0].appendChild(a)
break
case 3:r.complete?this.initBarrelBin(r,a,t,e.length):r.addEventListener("load",this.initBarrelBin.bind(this,r,a,t,e.length))
break
case 4:a.style.width=i.squareSize+"%",this.container.appendChild(a),a.style.height=a.offsetWidth+"px"}t<e.length-1&&(r.complete?this.addImage(e,t+1):r.addEventListener("load",this.addImage.bind(this,e,t+1)))},t.prototype.removeImage=function(e){i.imageUrl.splice(e,1),this.setImage(i.imageUrl,i)},t.prototype.setLayout=function(e){switch(i.layout=e||2,i.layout){case 2:this.container.className=this.containerSelector.slice(1)+" waterfall"
for(var t=i.coulumn,r=0;t>r;r++){var n=document.createElement("div")
n.className="ggalleryWaterfallColunms",n.id="coulumn-"+(r+1),this.container.appendChild(n)}break
case 3:this.container.className=this.containerSelector.slice(1)+" barrel"
break
case 4:this.container.className=this.containerSelector.slice(1)+" square"}},t.prototype.getStyle=function(){return i},t.prototype.getLayout=function(){return i.layout},t.prototype.setGutter=function(e,t){void 0===t&&(t=e)
for(var i=this.getImageDomElements(),r=0,n=i.length;n>r;r++)i[r].style.borderWidth=t/2+"px "+e/2+"px"},t.prototype.getGutter=function(){return i.gutter},t.prototype.enableFullscreen=function(){i.fullscreenState=!0,this.container.addEventListener("click",r,!1)},t.prototype.disableFullscreen=function(){i.fullscreenState=!1,this.container.removeEventListener("click",r,!1)},t.prototype.isFullscreenEnabled=function(){return i.fullscreenState},t.prototype.getMinWaterfallCoulumn=function(){for(var e=document.querySelectorAll(".ggalleryWaterfallColunms"),t=[],i=0;i<e.length;i++)t.push(e[i])
var r=t.sort(function(e,t){return e.offsetHeight-t.offsetHeight})
return r},t.prototype.getBarrelHeight=function(){return i.heightMin},t.prototype.initBarrelBin=function(e,t,r,n){i.barrelBinAspectRationow+=(e.width+10)/e.height
var a=this.container.offsetWidth/i.heightMin,l="",o=document.createElement("div")
if(o.className="ggalleryBarrelBinRows",o.style.width="100%",i.barrelBinAspectRationow<a)i.barrelBinCheckedImg.push(t)
else{i.barrelBinCheckedImg.push(t)
for(var c=0,s=i.barrelBinCheckedImg.length;s>c;c++)l=i.barrelBinCheckedImg[c].children[0],i.barrelBinCheckedImg[c].style.width=(l.width+10)/l.height*(this.container.offsetWidth/i.barrelBinAspectRationow)+"px",o.appendChild(i.barrelBinCheckedImg[c])
this.container.appendChild(o),o.style.height=this.container.offsetWidth/i.barrelBinAspectRationow+"px",i.barrelBinCheckedImg=[],i.barrelBinAspectRationow=0}if(r===n-1)for(var h=0,g=i.barrelBinCheckedImg.length;g>h;h++)l=i.barrelBinCheckedImg[h].children[0],i.barrelBinCheckedImg[h].style.width=l.width*i.heightMin/l.height+"px",o.appendChild(i.barrelBinCheckedImg[h]),this.container.appendChild(o)
var u=document.querySelectorAll(".ggalleryBarrelBinRows")
if(u)for(var d=0;d<u.length;d++)0===u[d].children.length&&this.container.removeChild(u[d])},void 0===e.Ggallery&&(e.Ggallery=function(e){return new t(e)})}(window)
